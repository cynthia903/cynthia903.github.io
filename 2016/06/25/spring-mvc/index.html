<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C"><meta name="google-site-verification" content="K7thEgdLm0UfRWJ5MGdF7sCcjClSzAlxFLPv2Oz5CGM"><title> Spring MVC 入门教程 · Qida's Blog</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Spring MVC 入门教程 - Qida's Blog"><meta name="keywords"><meta name="author" content="Qida's Blog"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="https://qidawu.github.io/atom.xml" title="Qida's Blog"><meta name="generator" content="Hexo 4.2.1"></head><body><header><div class="header row"> <a href="/" class="logo-link"><img src="/images/logo.png"></a><a href="/" class="title-link">Qida's Blog</a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><div id="postAr" class="post"><article class="post-block"><h1 class="post-title">Spring MVC 入门教程</h1><div class="post-info">2016-06-25<a href="/tags/Java/" title="Java" class="post-demo">Java</a><a href="/tags/Spring/" title="Spring" class="post-demo">Spring</a></div><div class="post-content"><p>一张图简要描述 Spring MVC 的处理流程：</p>
<p><img src="/img/spring/spring-mvc.png" alt="Spring MVC"></p>
<ul>
<li>Spring MVC 的核心前端控制器 <code>DispatcherServlet</code> 接收 HTTP 请求并询问 <code>Handler mapping</code> 该请求应该转发到哪个 <code>Controller</code> 方法。</li>
<li><code>Controller</code> 业务处理完毕，返回 <em>逻辑视图名(通常是一个字符串)</em> 。</li>
<li>最后 <code>viewResolver</code> 解析逻辑视图名并返回相应的 <code>View</code>，如 JSP、FreeMarker。</li>
</ul>
<h1 id="实现一个-Controller"><a href="#实现一个-Controller" class="headerlink" title="实现一个 Controller"></a>实现一个 Controller</h1><p>下面介绍编写控制器过程中常用的注解：</p>
<h2 id="定义一个控制器"><a href="#定义一个控制器" class="headerlink" title="定义一个控制器"></a>定义一个控制器</h2><h3 id="Controller"><a href="#Controller" class="headerlink" title="@Controller"></a>@Controller</h3><p>Traditional MVC controller relying on a <a href="https://spring.io/understanding/view-templates" target="_blank" rel="noopener">view technology</a> to perform server-side rendering.</p>
<h3 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h3><p>RESTful web service controller simply populates and returns a object that will be written directly to the HTTP response as JSON. Thanks to Spring’s HTTP message converter support, you don’t need to do this conversion manually. Because <a href="http://wiki.fasterxml.com/JacksonHome" target="_blank" rel="noopener">Jackson 2</a> is on the classpath, Spring’s <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.html" target="_blank" rel="noopener"><code>MappingJackson2HttpMessageConverter</code></a> is automatically chosen to convert the object to JSON.</p>
<p>It’s shorthand for <code>@Controller</code> and <code>@ResponseBody</code> rolled together. </p>
<h2 id="映射请求"><a href="#映射请求" class="headerlink" title="映射请求"></a>映射请求</h2><h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="@RequestMapping"></a>@RequestMapping</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html" target="_blank" rel="noopener"><code>@RequestMapping</code></a> 用于将 HTTP 请求映射到指定的 <code>Controller</code> 类或方法。</p>
<p>一、可匹配的请求属性如下：</p>
<ul>
<li><code>value</code> 用于匹配指定的请求路径，例如：<code>value = &quot;/index&quot;</code>。</li>
<li><code>method</code> 用于匹配指定的请求方法，例如：<code>method = RequestMethod.POST</code>。</li>
<li><code>consumes</code> 用于匹配指定的请求头 <code>Content-Type</code>，例如：<code>consumes = MediaType.APPLICATION_JSON_UTF8_VALUE</code>。</li>
<li><code>produces</code> 用于匹配指定的请求头 <code>Accept</code>，例如：<code>produces = MediaType.APPLICATION_JSON_UTF8_VALUE</code>。</li>
<li><code>params</code> 用于匹配指定的请求参数，例如：<ul>
<li>匹配存在：<code>params = &quot;myParam&quot;</code></li>
<li>匹配不存在：<code>params = &quot;!myParam&quot;</code></li>
<li>匹配指定参数值：<code>params = &quot;myParam=myValue&quot;</code> </li>
</ul>
</li>
<li><code>headers</code> 用于匹配指定的请求头，例如：<ul>
<li>匹配存在：<code>headers = &quot;myHeader&quot;</code></li>
<li>匹配不存在：<code>headers = &quot;!myHeader&quot;</code></li>
<li>匹配指定值：<code>headers = &quot;myHeader=myValue&quot;</code></li>
</ul>
</li>
</ul>
<p>尽管你可以使用媒体类型通配符（例如：<code>content-type=text/*</code> 或 <code>accept=xxx</code>）去匹配 <code>Content-Type</code> 或 <code>Accept</code> 请求头，但还是更推荐使用 <code>consumes</code> 或 <code>produces</code> 属性。因为它们专门用于此目的。</p>
<p>二、Spring Framework 4.3 还引入了五个等价的变体注解，相当于 <code>@RequestMapping</code> 注解与 <code>method</code> 属性的组合使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping</span><br><span class="line">@PostMapping</span><br><span class="line">@PutMapping</span><br><span class="line">@DeleteMapping</span><br><span class="line">@PatchMapping</span><br></pre></td></tr></table></figure>

<p>三、标注了 <code>@RequestMapping</code> 注解的方法可以拥有非常灵活的方法签名。支持以下参数类型/注解、返回类型/注解：</p>
<h2 id="方法参数类型"><a href="#方法参数类型" class="headerlink" title="方法参数类型"></a>方法参数类型</h2><p><code>@RequestMapping</code> 注解的方法，参数可以是下列任一类型：</p>
<h3 id="Request-Response"><a href="#Request-Response" class="headerlink" title="Request / Response"></a>Request / Response</h3><p>用于访问当前 <code>javax.servlet.http.HttpServletRequest</code> / <code>javax.servlet.http.HttpServletResponse</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">    request.getHeader(<span class="string">"host"</span>); <span class="comment">// 读取指定 HTTP 请求头</span></span><br><span class="line">    response.getWriter().write(<span class="string">"hello world"</span>); <span class="comment">// 浏览器将会显示：hello world</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用这类方法参数有点类似于传统的 Servlet 编程。</p>
<h3 id="InputStream-Reader"><a href="#InputStream-Reader" class="headerlink" title="InputStream / Reader"></a>InputStream / Reader</h3><p>用于访问当前请求内容的 <code>java.io.InputStream</code> / <code>java.io.Reader</code></p>
<h3 id="OutputStream-Writer"><a href="#OutputStream-Writer" class="headerlink" title="OutputStream / Writer"></a>OutputStream / Writer</h3><p>用于生成当前响应内容的 <code>java.io.OutputStream</code> / <code>java.io.Writer</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">(Writer writer)</span> </span>&#123;</span><br><span class="line">    writer.write(<span class="string">"hello world"</span>); <span class="comment">// 浏览器将会显示：hello world</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>用于访问当前 <code>javax.servlet.http.HttpSession</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">(HttpSession session)</span> </span>&#123;</span><br><span class="line">    session.getAttribute(<span class="string">"xxx"</span>); <span class="comment">// 读取指定 Session 值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HttpEntity-lt-gt"><a href="#HttpEntity-lt-gt" class="headerlink" title="HttpEntity&lt;?&gt;"></a>HttpEntity&lt;?&gt;</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/HttpEntity.html" target="_blank" rel="noopener"><code>HttpEntity&lt;?&gt;</code></a> 用于同时访问 <em>HTTP 请求头和请求体（HTTP request headers and contents）</em> 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">(HttpEntity&lt;String&gt; httpEntity)</span> </span>&#123;</span><br><span class="line">    String body = httpEntity.getBody();</span><br><span class="line">    HttpHeaders headers = httpEntity.getHeaders();</span><br><span class="line">    String host = headers.getFirst(<span class="string">"host"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Map-Model-ModelMap"><a href="#Map-Model-ModelMap" class="headerlink" title="Map / Model / ModelMap"></a>Map / Model / ModelMap</h3><p><code>Map</code> / <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/ui/Model.html" target="_blank" rel="noopener"><code>Model</code></a> / <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/ui/ModelMap.html" target="_blank" rel="noopener"><code>ModelMap</code></a> 用于在 <code>Controller</code> 层填充将会暴露给 <code>View</code> 层的 <code>Model</code> 对象。</p>
<h2 id="方法参数注解"><a href="#方法参数注解" class="headerlink" title="方法参数注解"></a>方法参数注解</h2><p>尽管使用常规类型的方法参数更接近于人们所熟悉的传统 Servlet 编程，但在 Spring 编程中却不建议这么做。因为这样会导致 JavaBean 与 Servlet 容器耦合，侵入性强，难以进行单元测试（如 Mock 测试）。最佳实践应当是传入注解后被解析好的数据类型，下面介绍这些常用的注解：</p>
<h3 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a>@PathVariable</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/PathVariable.html" target="_blank" rel="noopener"><code>@PathVariable</code></a> 用于标注某个方法参数与某个 <em>URI 模板变量（URI template variable）</em> 的绑定关系，常用于 <em>RESTful URL</em>，例如 <code>/hotels/{hotel}</code>。</p>
<h3 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a>@RequestParam</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestParam.html" target="_blank" rel="noopener"><code>@RequestParam</code></a> 用于标注某个方法参数与某个 <em>HTTP 请求参数（HTTP request parameter）</em> 的绑定关系。</p>
<p>使用时需要注意 <code>required</code> 这个属性：</p>
<ul>
<li>方法参数不写 <code>@RequestParam</code>，默认的 <code>required</code> 为 <code>false</code></li>
<li>方法参数写了 <code>@RequestParam</code>，默认的 <code>required</code> 为 <code>true</code></li>
<li>方法参数同时写了 <code>@RequestParam</code> + <code>defaultValue</code>，默认的 <code>required</code> 为 <code>false</code></li>
</ul>
<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;test HTTP&#x2F;1.1</span><br><span class="line">Host: localhost:8080</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">data&#x3D;123,234</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;test?data&#x3D;123,234 HTTP&#x2F;1.1</span><br><span class="line">Host: localhost:8080</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(@RequestParam(<span class="string">"data"</span>)</span> String data) </span>&#123;</span><br><span class="line">    log.info(data);  <span class="comment">// 123, 234</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Type conversion is applied automatically if the target method parameter type is not String. See the section called “<a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#mvc-ann-typeconversion" target="_blank" rel="noopener">Method Parameters And Type Conversion</a>”.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(@RequestParam(<span class="string">"data"</span>)</span> ArrayList&lt;String&gt; data) </span>&#123;</span><br><span class="line">    log.info(data.toString());  <span class="comment">// 123, 234</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When an <code>@RequestParam</code> annotation is used on a <code>Map&lt;String, String&gt;</code> or <code>MultiValueMap&lt;String, String&gt;</code> argument, the map is populated with all request parameters.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(@RequestParam(<span class="string">"data"</span>)</span> Map&lt;String, String&gt; data) </span>&#123;</span><br><span class="line">    log.info(data.get(<span class="string">"data"</span>));  <span class="comment">// 123, 234</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a>@RequestBody</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestBody.html" target="_blank" rel="noopener"><code>@RequestBody</code></a> 用于标注某个方法参数与某个 <em>HTTP 请求体（HTTP request body）</em> 的绑定关系。 <code>@RequestBody</code> 会调用合适的 <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/HttpMessageConverter.html" target="_blank" rel="noopener">message converters</a> 将 <em>HTTP 请求体（HTTP request body）</em> 写入指定对象，默认的 `HttpMessageConverter 如下：</p>
<ul>
<li><code>ByteArrayHttpMessageConverter</code> converts byte arrays.</li>
<li><code>StringHttpMessageConverter</code> converts strings.</li>
<li><code>FormHttpMessageConverter</code> converts form data to/from a MultiValueMap&lt;String, String&gt;.</li>
<li><code>SourceHttpMessageConverter</code> converts to/from a javax.xml.transform.Source.</li>
</ul>
<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;test HTTP&#x2F;1.1</span><br><span class="line">Host: localhost:8080</span><br><span class="line">Content-Type: application&#x2F;json</span><br><span class="line"></span><br><span class="line">[&quot;123&quot;, &quot;234&quot;]</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(@RequestBody List&lt;String&gt; data)</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>An <code>@RequestBody</code> method parameter can be annotated with <code>@Valid</code>, in which case it will be validated using the configured <code>Validator</code> instance. When using the MVC namespace or the MVC Java config, a JSR-303 validator is configured automatically assuming a JSR-303 implementation is available on the classpath.</p>
<h3 id="RequestHeader"><a href="#RequestHeader" class="headerlink" title="@RequestHeader"></a>@RequestHeader</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestHeader.html" target="_blank" rel="noopener"><code>@RequestHeader</code></a> 用于标注某个方法参数与某个 <em>HTTP 请求头（HTTP request header）</em> 的绑定关系。</p>
<h3 id="CookieValue"><a href="#CookieValue" class="headerlink" title="@CookieValue"></a>@CookieValue</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/CookieValue.html" target="_blank" rel="noopener"><code>@CookieValue</code></a> 用于标注某个方法参数与某个 <em>HTTP cookie</em> 的绑定关系。方法参数可以是 <code>javax.servlet.http.Cookie</code>，也可以是具体的 Cookie 值（如字符串、数字类型等）。</p>
<p>举个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Employee <span class="title">getEmployeeBy</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    @RequestParam(<span class="string">"name"</span>)</span> String name, </span></span><br><span class="line"><span class="function">    @<span class="title">RequestHeader</span><span class="params">(<span class="string">"host"</span>)</span> String host, </span></span><br><span class="line"><span class="function">    @RequestBody String body) </span>&#123;...&#125;</span><br></pre></td></tr></table></figure>

<h2 id="方法参数验证"><a href="#方法参数验证" class="headerlink" title="方法参数验证"></a>方法参数验证</h2><p>Spring MVC 可以快速整合 JSR 303 - Bean Validation 实现方法参数校验，用法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/test"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(@Validated RequestVO request, BindingResult bindingResult)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (bindingResult.hasErrors()) &#123;</span><br><span class="line">        String errMsg = bindingResult.getAllErrors().stream()</span><br><span class="line">                .map(DefaultMessageSourceResolvable::getDefaultMessage)</span><br><span class="line">                .collect(Collectors.joining(<span class="string">", "</span>));</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用到：</p>
<p><code>org.springframework.validation.annotation.Validated</code> 注解</p>
<p><code>org.springframework.validation.BindingResult</code> 接口</p>
<p>参考：</p>
<p>《<a href="https://blog.csdn.net/VagueCoder/article/details/48398517" target="_blank" rel="noopener">Spring4新特性——集成Bean Validation 1.1(JSR-349)到SpringMVC</a>》</p>
<h2 id="方法返回类型"><a href="#方法返回类型" class="headerlink" title="方法返回类型"></a>方法返回类型</h2><p><code>@RequestMapping</code> 注解的方法，返回类型可以是下列任一常规类型：</p>
<h3 id="HttpEntity-lt-gt-1"><a href="#HttpEntity-lt-gt-1" class="headerlink" title="HttpEntity&lt;?&gt;"></a>HttpEntity&lt;?&gt;</h3><p><code>org.springframework.http.HttpEntity</code></p>
<p>Represents an HTTP request or response entity, consisting of headers and body.</p>
<p>Typically used in combination with the <code>RestTemplate</code>, like so:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HttpHeaders headers = <span class="keyword">new</span> HttpHeaders();</span><br><span class="line">headers.setContentType(MediaType.TEXT_PLAIN);</span><br><span class="line">HttpEntity&lt;String&gt; entity = <span class="keyword">new</span> HttpEntity&lt;String&gt;(helloWorld, headers);</span><br><span class="line">URI location = template.postForLocation(<span class="string">"http://example.com"</span>, entity);</span><br></pre></td></tr></table></figure>

<p>or</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HttpEntity&lt;String&gt; entity = template.getForEntity(<span class="string">"http://example.com"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">String body = entity.getBody();</span><br><span class="line">MediaType contentType = entity.getHeaders().getContentType();</span><br></pre></td></tr></table></figure>

<p>Can also be used in Spring MVC, as a return value from a <code>@Controller</code> method:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/handle"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> HttpEntity&lt;String&gt; <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  HttpHeaders responseHeaders = <span class="keyword">new</span> HttpHeaders();</span><br><span class="line">  responseHeaders.set(<span class="string">"MyResponseHeader"</span>, <span class="string">"MyValue"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> HttpEntity&lt;String&gt;(<span class="string">"Hello World"</span>, responseHeaders);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ResponseEntity-lt-gt"><a href="#ResponseEntity-lt-gt" class="headerlink" title="ResponseEntity&lt;?&gt;"></a>ResponseEntity&lt;?&gt;</h3><p><code>org.springframework.http.ResponseEntity</code></p>
<p>Extension of <code>HttpEntity</code> that adds a <code>HttpStatus</code> status code. Used in <code>RestTemplate</code> as well <code>@Controller</code> methods.</p>
<p>In <code>RestTemplate</code>, this class is returned by <code>getForEntity()</code> and <code>exchange()</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ResponseEntity&lt;String&gt; entity = template.getForEntity(<span class="string">"http://example.com"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">String body = entity.getBody();</span><br><span class="line">MediaType contentType = entity.getHeaders().getContentType();</span><br><span class="line">HttpStatus statusCode = entity.getStatusCode();</span><br></pre></td></tr></table></figure>

<p>Can also be used in Spring MVC, as the return value from a <code>@Controller</code> method:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/handle"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  URI location = ...;</span><br><span class="line">  HttpHeaders responseHeaders = <span class="keyword">new</span> HttpHeaders();</span><br><span class="line">  responseHeaders.setLocation(location);</span><br><span class="line">  responseHeaders.set(<span class="string">"MyResponseHeader"</span>, <span class="string">"MyValue"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;String&gt;(<span class="string">"Hello World"</span>, responseHeaders, HttpStatus.CREATED);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Or, by using a builder accessible via static methods:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/handle"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  URI location = ...;</span><br><span class="line">  <span class="keyword">return</span> ResponseEntity.created(location).header(<span class="string">"MyResponseHeader"</span>, <span class="string">"MyValue"</span>).body(<span class="string">"Hello World"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ModelAndView"><a href="#ModelAndView" class="headerlink" title="ModelAndView"></a>ModelAndView</h3><p><code>org.springframework.web.servlet.ModelAndView</code></p>
<p>Holder for both Model and View in the web MVC framework.</p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>表示直接返回视图名。</p>
<h2 id="方法返回注解"><a href="#方法返回注解" class="headerlink" title="方法返回注解"></a>方法返回注解</h2><h3 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a>@ResponseBody</h3><p>用于标注某个方法返回值与 <em>WEB 响应体（response body）</em> 的绑定关系。 <code>@ResponseBody</code> 会跳过 <code>ViewResolver</code> 部分，调用合适的 <a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/http/converter/HttpMessageConverter.html" target="_blank" rel="noopener">message converters</a>，将方法返回值作为 <em>WEB 响应体（response body）</em> 写入输出流。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Date <span class="title">go</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ResponseStatus"><a href="#ResponseStatus" class="headerlink" title="@ResponseStatus"></a>@ResponseStatus</h3><p><a href="http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/ResponseStatus.html" target="_blank" rel="noopener"><code>@ResponseStatus</code></a> 用于返回 HTTP 响应码，例如返回 404：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line"><span class="meta">@ResponseStatus</span>(value = HttpStatus.NOT_FOUND, reason = <span class="string">"找不到网页"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="视图处理"><a href="#视图处理" class="headerlink" title="视图处理"></a>视图处理</h1><h1 id="统一异常处理"><a href="#统一异常处理" class="headerlink" title="统一异常处理"></a>统一异常处理</h1><p>Classes annotated with <code>@ControllerAdvice</code> can contain <code>@ExceptionHandler</code>, <code>@InitBinder</code>, and <code>@ModelAttribute</code> annotated methods, and these methods will apply to <code>@RequestMapping</code> methods across all controller hierarchies as opposed to the controller hierarchy within which they are declared.</p>
<p><code>@RestControllerAdvice</code> is an alternative where <code>@ExceptionHandler</code> methods assume <code>@ResponseBody</code> semantics by default.</p>
<p>Both <code>@ControllerAdvice</code> and <code>@RestControllerAdvice</code> can target a subset of controllers:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Target all Controllers annotated with @RestController</span><br><span class="line">@ControllerAdvice(annotations &#x3D; RestController.class)</span><br><span class="line">public class AnnotationAdvice &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Target all Controllers within specific packages</span><br><span class="line">@ControllerAdvice(&quot;org.example.controllers&quot;)</span><br><span class="line">public class BasePackageAdvice &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Target all Controllers assignable to specific classes</span><br><span class="line">@ControllerAdvice(assignableTypes &#x3D; &#123;ControllerInterface.class, AbstractController.class&#125;)</span><br><span class="line">public class AssignableTypesAdvice &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(Throwable<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ResponseEntity</span>&lt;<span class="title">String</span>&gt; <span class="title">handleException</span>(<span class="title">Throwable</span> <span class="title">e</span>)</span>&#123;</span><br><span class="line">        log.error(e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(e.getMessage(), HttpStatus.valueOf(<span class="number">500</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="CORS-支持"><a href="#CORS-支持" class="headerlink" title="CORS 支持"></a>CORS 支持</h1><h1 id="核心配置"><a href="#核心配置" class="headerlink" title="核心配置"></a>核心配置</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>《<a href="https://spring.io/guides/gs/serving-web-content/" target="_blank" rel="noopener">Serving Web Content with Spring MVC</a>》</p>
<p>《<a href="https://spring.io/guides/gs/rest-service/" target="_blank" rel="noopener">Building a RESTful Web Service</a>》</p>
<p>《<a href="https://spring.io/guides/gs/rest-service-cors/" target="_blank" rel="noopener">Enabling Cross Origin Requests for a RESTful Web Service</a>》</p>
</div></article></div><div class="right-container"><div class="widget"><div class="tagcloud"><h4>标签云</h4><a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/DNS/" style="font-size: 12.5px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/GNU-Linux/" style="font-size: 16.67px;">GNU/Linux</a> <a href="/tags/Git/" style="font-size: 17.5px;">Git</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/MySQL/" style="font-size: 19.17px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 11.67px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 10.83px;">Redis</a> <a href="/tags/Spring/" style="font-size: 15.83px;">Spring</a> <a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">函数式编程</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 18.33px;">前端</a> <a href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">响应式编程</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 12.5px;">安全</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">并发编程</a> <a href="/tags/%E5%BB%BA%E7%AB%99/" style="font-size: 13.33px;">建站</a> <a href="/tags/%E7%AE%A1%E7%90%86/" style="font-size: 12.5px;">管理</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.17px;">读书笔记</a> <a href="/tags/%E9%87%91%E8%9E%8D/" style="font-size: 12.5px;">金融</a></div></div><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a href="/2016/07/05/javascript-requirejs/" class="prev">PREV</a><a href="/2016/05/22/javascript-event-delegation/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2021 <a href="https://github.com/qidawu" target="_blank">Qida's Blog</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <br> and <a href="https://github.com/Bulandent/hexo-theme-bubuzou" target="_blank">hexo-theme-bubuzou</a></p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="/scripts/jquery-1.8.2.min.js"></script><script src="https://cdn1.lncld.net/static/js/av-mini-0.6.10.js"></script><script src="/scripts/hit-kounter-lc-0.2.0.js"></script><script src="/scripts/arAnchor.js"></script><script src="/scripts/main.js"></script></body></html>