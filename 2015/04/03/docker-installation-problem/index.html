<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="1EB8XoOl0C"><meta name="google-site-verification" content="K7thEgdLm0UfRWJ5MGdF7sCcjClSzAlxFLPv2Oz5CGM"><title> Docker 启动失败问题处理 · Qida's Blog</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Docker 启动失败问题处理 - Qida's Blog"><meta name="keywords"><meta name="author" content="Qida's Blog"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/bubuzou.css"><link rel="search" type="application/opensearchdescription+xml" href="https://qidawu.github.io/atom.xml" title="Qida's Blog"><meta name="generator" content="Hexo 4.2.1"></head><body><header><div class="header row"> <a href="/" class="logo-link"><img src="/images/logo.png"></a><a href="/" class="title-link">Qida's Blog</a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" data-hover="博文" class="nav-list-link">博文</a></li><li class="nav-list-item"><a href="/archives/" target="_self" data-hover="归档" class="nav-list-link">归档</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div></div></header><div class="row scroll-con"><section class="container"><!-- for archive page--><div id="postAr" class="post"><article class="post-block"><h1 class="post-title">Docker 启动失败问题处理</h1><div class="post-info">2015-04-03<a href="/tags/Docker/" title="Docker" class="post-demo">Docker</a></div><div class="post-content"><p>Q1 参加了一场 Docker 技术分享后，发现了 Docker 这个好东西，回头动手安装，打算跑起来体验一番，却遇到了一些蛋疼的问题。</p>
<h1 id="如何安装-Docker"><a href="#如何安装-Docker" class="headerlink" title="如何安装 Docker"></a>如何安装 Docker</h1><p>Windows 如何安装 Docker？参考 <a href="https://docs.docker.com/installation/windows/" target="_blank" rel="noopener">官网安装教程</a> 。</p>
<p>由于 Docker 引擎使用了 Linux 特有的内核特性，因此在 Windows 中运行 Docker 需要使用一个轻量级的虚拟机。方便起见，Docker 团队设计了一个名为“Boot2Docker”的辅助程序用于安装所需的虚拟机并用于运行 Docker 进程。</p>
<p>此外，由于 Docker 对镜像（Image）的增删改查操作都是通过 Git ，因此在 Windows 下，还需要一个 MSYS-git 客户端。</p>
<p>因此，Boot2Docker 内置：</p>
<ul>
<li>Boot2Docker</li>
<li>Boot2Docker Management Tool</li>
<li><a href="https://www.virtualbox.org" target="_blank" rel="noopener">VirtualBox</a></li>
<li><a href="http://msysgit.github.io/" target="_blank" rel="noopener">MSYS-git</a></li>
</ul>
<p>需要注意，如果之前本地已经安装过 Git / GitHub for Windows 、VirtualBox ，则无需再安装内置的 MSYS-git、 VirtualBox 。</p>
<h1 id="VirtualBox-导致的启动失败问题"><a href="#VirtualBox-导致的启动失败问题" class="headerlink" title="VirtualBox 导致的启动失败问题"></a>VirtualBox 导致的启动失败问题</h1><h2 id="初始化（docker-init）失败问题处理"><a href="#初始化（docker-init）失败问题处理" class="headerlink" title="初始化（docker init）失败问题处理"></a>初始化（docker init）失败问题处理</h2><p>安装成功后，使用 Git Shell 运行启动脚本，结果却报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ start.sh</span><br><span class="line">copying initial boot2docker.iso (run &quot;boot2docker.exe download&quot; to update)</span><br><span class="line">initializing...</span><br><span class="line">error in run: Failed to initialize machine &quot;boot2docker-vm&quot;: exit status 1</span><br></pre></td></tr></table></figure>

<p>通过阅读 start.sh 脚本，发现卡在了 docker init 初始化这个步骤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;initializing...&#39;</span><br><span class="line">.&#x2F;boot2docker.exe init</span><br></pre></td></tr></table></figure>

<p>这时候，通过错误日志或控制台输出排查错误就很关键了，<code>-v</code> 参数可以用于显示详细的命令调用过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-v, --verbose&#x3D;false: display verbose command invocations.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ boot2docker.exe init -v</span><br><span class="line">Boot2Docker-cli version: v1.4.1</span><br><span class="line">Git commit: 43241cb</span><br><span class="line">2015&#x2F;04&#x2F;03 11:57:06 executing: E:\Developer\Oracle\VirtualBox\VBoxManage.exe showvminfo boot2docker-vm --machinereadable</span><br><span class="line">2015&#x2F;04&#x2F;03 11:57:06 executing: E:\Developer\Oracle\VirtualBox\VBoxManage.exe showvminfo boot2docker-vm --machinereadable</span><br><span class="line">2015&#x2F;04&#x2F;03 11:57:06 executing: E:\Developer\Oracle\VirtualBox\VBoxManage.exe list vms</span><br><span class="line">VBoxManage.exe: error: Failed to create the VirtualBox object!</span><br><span class="line">VBoxManage.exe: error: Code E_INVALIDARG (0x80070057) - One or more arguments are invalid (extended info not available)</span><br><span class="line">VBoxManage.exe: error: Most likely, the VirtualBox COM server is not running or failed to start.</span><br><span class="line">error in run: Failed to initialize machine &quot;boot2docker-vm&quot;: exit status 1</span><br></pre></td></tr></table></figure>

<p>通过控制台输出发现，VirtualBox 下的 <code>VBoxManage.exe</code> 运行出错了。</p>
<p>当时很疑惑，本地使用的是 Docker 内置 VirtualBox ，打开 <code>VirtualBox.exe</code>，同样会报错。</p>
<p>翻了下 VirtualBox 日志文件，Google 了一番输出错误，貌似跟什么 <a href="http://www.dotcoo.com/virtualbox-uxtheme" target="_blank" rel="noopener">Windows 破解主题的 DLL 文件</a>有关，折腾了一番没能解决。</p>
<p><a href="http://www.cnblogs.com/tanhangbo/p/4282605.html" target="_blank" rel="noopener">再次搜索</a>，最后发现了两个问题：</p>
<ol>
<li>程序兼容性问题导致 VirtualBox 无法打开；</li>
<li>VirtualBox 版本问题导致虚拟机无法启动；</li>
</ol>
<p>第一个问题，通过对 <code>VBoxManage.exe</code>、<code>VBoxManage.exe</code> 右键 - 勾选“以兼容模式运行这个程序”，至少保证打开程序不会报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ Oracle&#x2F;VirtualBox&#x2F;VBoxManage.exe list vms</span><br><span class="line">&quot;centos&quot; &#123;440faef3-b83d-4daa-b7ce-3942c03dc580&#125;</span><br></pre></td></tr></table></figure>

<p>第二个问题，通过多个版本的安装/卸载尝试，最后发现在我的电脑使用 VirtualBox 4.3.10 能够正常启动虚拟机。</p>
<h2 id="启动（docker-start）失败问题处理"><a href="#启动（docker-start）失败问题处理" class="headerlink" title="启动（docker start）失败问题处理"></a>启动（docker start）失败问题处理</h2><p>Docker 成功初始化后，还遇到一个虚拟化失败导致的 VirtualBox 无法启动的问题，报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line">VMSetError: VT-x is disabled in the BIOS.</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>打开 BIOS 的 Virtualization Technology (VTx/VTd) 开关，即可解决问题。</p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>再次运行 Docker 启动脚本，Docker 终于启动起来了！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">connecting...</span><br><span class="line">                        ##        .</span><br><span class="line">                  ## ## ##       &#x3D;&#x3D;</span><br><span class="line">               ## ## ## ##      &#x3D;&#x3D;&#x3D;</span><br><span class="line">           &#x2F;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;\___&#x2F; &#x3D;&#x3D;&#x3D;</span><br><span class="line">      ~~~ &#123;~~ ~~~~ ~~~ ~~~~ ~~ ~ &#x2F;  &#x3D;&#x3D;&#x3D;- ~~~</span><br><span class="line">           \______ o          __&#x2F;</span><br><span class="line">             \    \        __&#x2F;</span><br><span class="line">              \____\______&#x2F;</span><br><span class="line"> _                 _   ____     _            _</span><br><span class="line">| |__   ___   ___ | |_|___ \ __| | ___   ___| | _____ _ __</span><br><span class="line">| &#39;_ \ &#x2F; _ \ &#x2F; _ \| __| __) &#x2F; _&#96; |&#x2F; _ \ &#x2F; __| |&#x2F; &#x2F; _ \ &#39;__|</span><br><span class="line">| |_) | (_) | (_) | |_ &#x2F; __&#x2F; (_| | (_) | (__|   &lt;  __&#x2F; |</span><br><span class="line">|_.__&#x2F; \___&#x2F; \___&#x2F; \__|_____\__,_|\___&#x2F; \___|_|\_\___|_|</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>《<a href="http://www.cnblogs.com/tanhangbo/p/4282605.html" target="_blank" rel="noopener">virtualbox 打不开ubuntu解决</a>》</p>
</div></article></div><div class="right-container"><div class="widget"><div class="tagcloud"><h4>标签云</h4><a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/DNS/" style="font-size: 12.5px;">DNS</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/GNU-Linux/" style="font-size: 16.67px;">GNU/Linux</a> <a href="/tags/Git/" style="font-size: 17.5px;">Git</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/MySQL/" style="font-size: 19.17px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 11.67px;">Nginx</a> <a href="/tags/Redis/" style="font-size: 10.83px;">Redis</a> <a href="/tags/Spring/" style="font-size: 15.83px;">Spring</a> <a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">函数式编程</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 18.33px;">前端</a> <a href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">响应式编程</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 12.5px;">安全</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">并发编程</a> <a href="/tags/%E5%BB%BA%E7%AB%99/" style="font-size: 13.33px;">建站</a> <a href="/tags/%E7%AE%A1%E7%90%86/" style="font-size: 12.5px;">管理</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.17px;">读书笔记</a> <a href="/tags/%E9%87%91%E8%9E%8D/" style="font-size: 12.5px;">金融</a></div></div><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">搜索</label></div><div id="search_result" class="search-result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a href="/2015/04/06/broswer-kernel/" class="prev">PREV</a><a href="/2015/04/01/gnu-bash-prompting/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2021 <a href="https://github.com/qidawu" target="_blank">Qida's Blog</a></p><p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <br> and <a href="https://github.com/Bulandent/hexo-theme-bubuzou" target="_blank">hexo-theme-bubuzou</a></p></div><div class="totop"><i></i></div></div></footer><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script src="/scripts/jquery-1.8.2.min.js"></script><script src="https://cdn1.lncld.net/static/js/av-mini-0.6.10.js"></script><script src="/scripts/hit-kounter-lc-0.2.0.js"></script><script src="/scripts/arAnchor.js"></script><script src="/scripts/main.js"></script></body></html>